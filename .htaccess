<IfModule mod_rewrite.c>
  # Active le module de réécriture d'URL
  RewriteEngine On
  Options -MultiViews
  RewriteBase /

  # Sert l'index généré par Angular (placé dans dist/.../browser)
  DirectoryIndex browser/index.html

  # Laisse passer les fichiers/répertoires existants
  RewriteCond %{REQUEST_FILENAME} -f [OR]
  RewriteCond %{REQUEST_FILENAME} -d
  RewriteRule ^ - [L]

  # Évite la boucle si on est déjà sous /browser
  RewriteCond %{REQUEST_URI} !^/browser/

  # Redirige toutes les autres routes SPA vers l'index
  RewriteRule ^.*$ /browser/index.html [L]
</IfModule>

# ✅ Mise en cache des images (1 an)
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType image/jpg "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType image/webp "access plus 1 year"
  ExpiresByType image/svg+xml "access plus 1 year"
  ExpiresByType image/gif "access plus 1 year"
</IfModule>

<IfModule mod_headers.c>
  <FilesMatch "\.(jpg|jpeg|png|gif|webp|svg)$">
    Header set Cache-Control "public, max-age=31536000"
  </FilesMatch>
</IfModule>

# Fallback 404 vers l'index (au cas où mod_rewrite est indisponible)
ErrorDocument 404 /browser/index.html
